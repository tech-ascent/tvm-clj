<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tvm-clj.ast documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">tvm-clj</span> <span class="project-version">5.1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="background.html"><div class="inner"><span>Technical Background</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tvm-clj</span></div></div></li><li class="depth-2"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>application</span></div></div></li><li class="depth-3"><a href="tvm-clj.application.image.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>image</span></div></a></li><li class="depth-2 branch current"><a href="tvm-clj.ast.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>ast</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.compiler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compiler</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.device.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>device</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.module.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>module</span></div></a></li><li class="depth-2"><a href="tvm-clj.schedule.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schedule</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tvm-clj.ast.html#var-*varname-prefix*"><div class="inner"><span>*varname-prefix*</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var--.3Edtype"><div class="inner"><span>-&gt;dtype</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var--.3Eoperation"><div class="inner"><span>-&gt;operation</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-commutative-reduce"><div class="inner"><span>commutative-reduce</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-commutative-reducer"><div class="inner"><span>commutative-reducer</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-compute"><div class="inner"><span>compute</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-input-tensors"><div class="inner"><span>input-tensors</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-iteration-variable"><div class="inner"><span>iteration-variable</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-iteration-variable-type-set"><div class="inner"><span>iteration-variable-type-set</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-name-.3Ethread-axis-iterator"><div class="inner"><span>name-&gt;thread-axis-iterator</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-output-tensors"><div class="inner"><span>output-tensors</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-placeholder"><div class="inner"><span>placeholder</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-safe-str"><div class="inner"><span>safe-str</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tget"><div class="inner"><span>tget</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tvm-fn"><div class="inner"><span>tvm-fn</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tvm-fn-.3Eargs"><div class="inner"><span>tvm-fn-&gt;args</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tvm-fn-.3Ecommutative-reducer"><div class="inner"><span>tvm-fn-&gt;commutative-reducer</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tvm-let"><div class="inner"><span>tvm-let</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-variable"><div class="inner"><span>variable</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-when-not-error"><div class="inner"><span>when-not-error</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tvm-clj.ast</h1><div class="doc"><div class="markdown"><p>TVM’s algorithms are first described using an AST tailored towards ND-array programming.</p></div></div><div class="public anchor" id="var-*varname-prefix*"><h3>*varname-prefix*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L30">view source</a></div></div><div class="public anchor" id="var--.3Edtype"><h3>-&gt;dtype</h3><div class="usage"><code>(-&gt;dtype dtype-or-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L26">view source</a></div></div><div class="public anchor" id="var--.3Eoperation"><h3>-&gt;operation</h3><div class="usage"><code>(-&gt;operation tens-or-op)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L408">view source</a></div></div><div class="public anchor" id="var-commutative-reduce"><h3>commutative-reduce</h3><div class="usage"><code>(commutative-reduce comm-reducer reduce-axis read-exprs)</code></div><div class="doc"><div class="markdown"><p>Create a reduce node.</p>
<ul>
  <li><code>comm-reducer</code> - A commutative reducer produced via either <code>commutative-reducer</code> or <code>tvm-fn-&gt;commutative-reducer</code>.</li>
  <li><code>reduce-axis</code> - A list of either maps of {:domain :name} or <code>iteration-variable</code>’s  of type <code>:communicative-reduce</code>. If a list element is a map?, it will be interpreted  as a map of {:domain :name} in the corresponding iteration variable will be created for you.</li>
  <li>
  <p><code>read-exprs</code> - Either <code>fn?</code>’s or a list of expressions that must equal the number of  inputs to <code>commutative-reducer</code> and that must be based off of the variables defined  in <code>reduce-axis</code>. If read-exprs are clojure ’fn?’s they will be called  with the reduction variables created from reduce-axis.</p></li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L364">view source</a></div></div><div class="public anchor" id="var-commutative-reducer"><h3>commutative-reducer</h3><div class="usage"><code>(commutative-reducer reduce-fn-args reduction-ast-fns)</code></div><div class="doc"><div class="markdown"><p>Create a commutative reducer. Reducers are used in as the part of the commutative reduction pathway.</p>
<ul>
  <li><code>reduce-fn-args</code> - sequence of maps of {:name :datatype :argument-type :identity-value}  tell you the name of the argument, the datatype, and when the argument  is and <code>:accumulating</code> arg or an <code>:incoming</code> arg. If the argument is an accumulator argument  then an <code>:identity-value</code> must be provided.</li>
  <li><code>incoming-names</code> - Argument names of the incoming values.</li>
  <li><code>reduction-ast-fn</code> - fn taking ‘(+ (count accum-args) (count incoming-args))’  arguments and returning an AST that performs the reduction.</li>
</ul>
<p>Returns a commutative reducer you can use in <code>Reduce</code>.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L281">view source</a></div></div><div class="public anchor" id="var-compute"><h3>compute</h3><div class="usage"><code>(compute shape fcompute name &amp; {:keys [tag attrs], :or {tag ""}})</code></div><div class="doc"><div class="markdown"><p>Construct a new tensor by computing over the shape domain.</p>
<p>The compute rule is result[axis] = fcompute(axis)</p>
<h2><a href="#parameters" name="parameters"></a>Parameters</h2>
<p>shape: Array of Expr  The shape of the tensor</p>
<p>fcompute: lambda function of indices-&gt; value  Specifies the input source expression</p>
<p>name: str, optional  The name hint of the tensor</p>
<p>tag: str, optional  Additonal tag information about the compute.</p>
<p>attrs: dict, optional  The additional auxiliary attributes about the compute.</p>
<h2><a href="#returns" name="returns"></a>Returns</h2>
<p>The created compute node</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L233">view source</a></div></div><div class="public anchor" id="var-input-tensors"><h3>input-tensors</h3><div class="usage"><code>(input-tensors compute-op)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L403">view source</a></div></div><div class="public anchor" id="var-iteration-variable"><h3>iteration-variable</h3><div class="usage"><code>(iteration-variable domain name iteration-type &amp; {:keys [thread-tag], :or {thread-tag ""}})</code></div><div class="doc"><div class="markdown"><p>Create a variable that controls iteration through the data. The iteration type affects the class of optimizations that the compiler is able to apply to the affected expressions,</p>
<pre><code>Parameters
----------
dom : Range
    The domain of iteration.

name : str
    The name of iteration variable.

iteration-type : keyword
    The type of iteration.

thread-tag : str
    The thread tag of the iteration variable.
</code></pre></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L173">view source</a></div></div><div class="public anchor" id="var-iteration-variable-type-set"><h3>iteration-variable-type-set</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L170">view source</a></div></div><div class="public anchor" id="var-name-.3Ethread-axis-iterator"><h3>name-&gt;thread-axis-iterator</h3><div class="usage"><code>(name-&gt;thread-axis-iterator axis-name)</code></div><div class="doc"><div class="markdown"><p>Create a thread iter-var from a thread axis name</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L208">view source</a></div></div><div class="public anchor" id="var-output-tensors"><h3>output-tensors</h3><div class="usage"><code>(output-tensors compute-op)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L397">view source</a></div></div><div class="public anchor" id="var-placeholder"><h3>placeholder</h3><div class="usage"><code>(placeholder shape name &amp; {:keys [dtype], :or {dtype "float32"}})</code></div><div class="doc"><div class="markdown"><p>Create a user-supplied tensor variable</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L47">view source</a></div></div><div class="public anchor" id="var-safe-str"><h3>safe-str</h3><div class="usage"><code>(safe-str str-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L32">view source</a></div></div><div class="public anchor" id="var-tget"><h3>tget</h3><div class="usage"><code>(tget tensor indices)</code></div><div class="doc"><div class="markdown"><p>Get an item from a tensor</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L67">view source</a></div></div><div class="public anchor" id="var-tvm-fn"><h3>tvm-fn</h3><h4 class="type">macro</h4><div class="usage"><code>(tvm-fn arg-vec &amp; body)</code></div><div class="doc"><div class="markdown"><p>Like (fn) but retains the arglists. Lambda in clojure unfortunately does not.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L214">view source</a></div></div><div class="public anchor" id="var-tvm-fn-.3Eargs"><h3>tvm-fn-&gt;args</h3><div class="usage"><code>(tvm-fn-&gt;args tvm-fn)</code></div><div class="doc"><div class="markdown"><p>Get the vector of tvm-safe string argument names to a tvm function.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L222">view source</a></div></div><div class="public anchor" id="var-tvm-fn-.3Ecommutative-reducer"><h3>tvm-fn-&gt;commutative-reducer</h3><div class="usage"><code>(tvm-fn-&gt;commutative-reducer tvm-fn identity-values datatype)</code><code>(tvm-fn-&gt;commutative-reducer tvm-fn identity-values)</code></div><div class="doc"><div class="markdown"><p>Make a reducer out of a tvm function assuming all arguments are the same datatype.</p>
<p>Accumulation arguments are considered the first N arguments where N is the number of initial values. The rest of the arguments are considered incoming arguments. There must be at least one each of accumulation and incoming arguments.</p>
<ul>
  <li><code>tvm-fn</code> - a function with proper metadata such that <code>:arglists</code> can be found.</li>
  <li><code>identity-values</code> - list of identity values. This implicitly indicates the  number of accumulation arguments as there must be one identity value per  accumulation arguments.</li>
  <li><code>datatype</code> - Option datatype. If not provided will be inferred from the datatypes of identity-values.</li>
</ul></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L324">view source</a></div></div><div class="public anchor" id="var-tvm-let"><h3>tvm-let</h3><h4 class="type">macro</h4><div class="usage"><code>(tvm-let expr-pairs body)</code></div><div class="doc"><div class="markdown"><p>Lets in tvm must be nested. This leads to an exciting macro. Pairs must be of the form var val-expr. Body is <em>not</em> an implicit do!!</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L89">view source</a></div></div><div class="public anchor" id="var-variable"><h3>variable</h3><div class="usage"><code>(variable name &amp; {:keys [dtype], :or {dtype "int32"}})</code></div><div class="doc"><div class="markdown"><p>Create a scalar variable. Returns a node handle</p></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L40">view source</a></div></div><div class="public anchor" id="var-when-not-error"><h3>when-not-error</h3><h4 class="type">macro</h4><div class="usage"><code>(when-not-error condition throw-clause)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tvm-clj/blob/upgrade-to-latest/src/tvm_clj/ast.clj#L20">view source</a></div></div></div></body></html>