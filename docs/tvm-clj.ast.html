<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>tvm-clj.ast documentation</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="highlight/solarized-light.css" /><script type="text/javascript" src="highlight/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a> with <a href="https://github.com/xsc/codox-theme-rdash">RDash UI</a> theme</h2><h1><a href="index.html"><span class="project-title"><span class="project-name">tvm-clj</span> <span class="project-version">5.1-SNAPSHOT</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="background.html"><div class="inner"><span>Technical Background</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>tvm-clj</span></div></div></li><li class="depth-2 branch current"><a href="tvm-clj.ast.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>ast</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.compiler.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>compiler</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.device.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>device</span></div></a></li><li class="depth-2 branch"><a href="tvm-clj.module.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>module</span></div></a></li><li class="depth-2"><a href="tvm-clj.schedule.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>schedule</span></div></a></li></ul></div><div class="sidebar secondary"><h3><a href="#top"><span class="inner">Public Vars</span></a></h3><ul><li class="depth-1"><a href="tvm-clj.ast.html#var-*varname-prefix*"><div class="inner"><span>*varname-prefix*</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var--.3Ecall-type"><div class="inner"><span>-&gt;call-type</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var--.3Edtype"><div class="inner"><span>-&gt;dtype</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var--.3Eoperation"><div class="inner"><span>-&gt;operation</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-add"><div class="inner"><span>add</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-call"><div class="inner"><span>call</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-call-intrin"><div class="inner"><span>call-intrin</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-call-pure-intrin"><div class="inner"><span>call-pure-intrin</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-call-type-set"><div class="inner"><span>call-type-set</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-call-types"><div class="inner"><span>call-types</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-cast"><div class="inner"><span>cast</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-commutative-reduce"><div class="inner"><span>commutative-reduce</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-compute"><div class="inner"><span>compute</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-const"><div class="inner"><span>const</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-def-bin-intrin-op"><div class="inner"><span>def-bin-intrin-op</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-def-bin-op"><div class="inner"><span>def-bin-op</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-def-intrin-op"><div class="inner"><span>def-intrin-op</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-def-op"><div class="inner"><span>def-op</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-input-tensors"><div class="inner"><span>input-tensors</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-iteration-variable"><div class="inner"><span>iteration-variable</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-iteration-variable-type-set"><div class="inner"><span>iteration-variable-type-set</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-iteration-variable-types"><div class="inner"><span>iteration-variable-types</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-name-.3Ethread-axis-iterator"><div class="inner"><span>name-&gt;thread-axis-iterator</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-output-tensors"><div class="inner"><span>output-tensors</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-placeholder"><div class="inner"><span>placeholder</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-range"><div class="inner"><span>range</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-safe-str"><div class="inner"><span>safe-str</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-select"><div class="inner"><span>select</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-static-cast"><div class="inner"><span>static-cast</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tget"><div class="inner"><span>tget</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tvm-fn"><div class="inner"><span>tvm-fn</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-tvm-let"><div class="inner"><span>tvm-let</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-variable"><div class="inner"><span>variable</span></div></a></li><li class="depth-1"><a href="tvm-clj.ast.html#var-when-not-error"><div class="inner"><span>when-not-error</span></div></a></li></ul></div><div class="namespace-docs" id="content"><h1 class="anchor" id="top">tvm-clj.ast</h1><div class="doc"><div class="markdown"><p>TVM’s algorithms are first described using an AST tailored towards ND-array programming.</p></div></div><div class="public anchor" id="var-*varname-prefix*"><h3>*varname-prefix*</h3><h4 class="dynamic">dynamic</h4><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L28">view source</a></div></div><div class="public anchor" id="var--.3Ecall-type"><h3>-&gt;call-type</h3><div class="usage"><code>(-&gt;call-type ctype)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L92">view source</a></div></div><div class="public anchor" id="var--.3Edtype"><h3>-&gt;dtype</h3><div class="usage"><code>(-&gt;dtype dtype-or-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L24">view source</a></div></div><div class="public anchor" id="var--.3Eoperation"><h3>-&gt;operation</h3><div class="usage"><code>(-&gt;operation tens-or-op)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L499">view source</a></div></div><div class="public anchor" id="var-add"><h3>add</h3><div class="usage"><code>(add lhs rhs)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L242">view source</a></div></div><div class="public anchor" id="var-call"><h3>call</h3><div class="usage"><code>(call ret-dtype fn-name fn-args call-type function-ref value-index)</code></div><div class="doc"><div class="markdown"><p>Call a ‘function’, which is basically executing a statement. For instance, getting a value from the tensor is calling a halide function with the tensor’s generating-op and value index.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L107">view source</a></div></div><div class="public anchor" id="var-call-intrin"><h3>call-intrin</h3><div class="usage"><code>(call-intrin dtype func-name &amp; args)</code></div><div class="doc"><div class="markdown"><p>Build expression by calling an intrinsic function.</p>
<p>Intrinsics can be overloaded with multiple data types via the intrinsic translation rule.</p>
<h2><a href="#parameters" name="parameters"></a>Parameters</h2>
<p>dtype : str  The data type of the result.</p>
<p>func_name: str  The intrinsic function name.</p>
<p>args : list  Positional arguments.</p>
<h2><a href="#returns" name="returns"></a>Returns</h2>
<p>call : Expr  The call expression.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L144">view source</a></div></div><div class="public anchor" id="var-call-pure-intrin"><h3>call-pure-intrin</h3><div class="usage"><code>(call-pure-intrin dtype func-name &amp; args)</code></div><div class="doc"><div class="markdown"><p>Build expression by calling a pure intrinsic function.</p>
<p>Intrinsics can be overloaded with multiple data types via the intrinsic translation rule.</p>
<h2><a href="#parameters" name="parameters"></a>Parameters</h2>
<p>dtype : str  The data type of the result.</p>
<p>func_name: str  The intrinsic function name.</p>
<p>args : list  Positional arguments.</p>
<h2><a href="#returns" name="returns"></a>Returns</h2>
<p>call : Expr  The call expression.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L118">view source</a></div></div><div class="public anchor" id="var-call-type-set"><h3>call-type-set</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L104">view source</a></div></div><div class="public anchor" id="var-call-types"><h3>call-types</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Possible call types from Halide/IR.h</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L82">view source</a></div></div><div class="public anchor" id="var-cast"><h3>cast</h3><div class="usage"><code>(cast expr-node dtype)</code></div><div class="doc"><div class="markdown"><p>See static cast redone to allow usage in -&gt;</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L76">view source</a></div></div><div class="public anchor" id="var-commutative-reduce"><h3>commutative-reduce</h3><div class="usage"><code>(commutative-reduce reduce-op identity-val dtype expr-seq axis-seq)</code></div><div class="doc"><div class="markdown"><p>1 left hand side, first var of reduce operation N right hand sides, rest of the variables of the reduce operation identity-val - initialization of left hand side.n expr-ary - one for each (const) right hand side. dtype - datatype of all inputs to reduction</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L465">view source</a></div></div><div class="public anchor" id="var-compute"><h3>compute</h3><div class="usage"><code>(compute shape fcompute name &amp; {:keys [tag attrs], :or {tag ""}})</code></div><div class="doc"><div class="markdown"><p>Construct a new tensor by computing over the shape domain.</p>
<p>The compute rule is result[axis] = fcompute(axis)</p>
<h2><a href="#parameters" name="parameters"></a>Parameters</h2>
<p>shape: Array of Expr  The shape of the tensor</p>
<p>fcompute: lambda function of indices-&gt; value  Specifies the input source expression</p>
<p>name: str, optional  The name hint of the tensor</p>
<p>tag: str, optional  Additonal tag information about the compute.</p>
<p>attrs: dict, optional  The additional auxiliary attributes about the compute.</p>
<h2><a href="#returns" name="returns"></a>Returns</h2>
<p>The created compute node</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L415">view source</a></div></div><div class="public anchor" id="var-const"><h3>const</h3><div class="usage"><code>(const numeric-value &amp; [dtype])</code></div><div class="doc"><div class="markdown"><p>Convert an item to a const (immediate) value</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L64">view source</a></div></div><div class="public anchor" id="var-def-bin-intrin-op"><h3>def-bin-intrin-op</h3><h4 class="type">macro</h4><div class="usage"><code>(def-bin-intrin-op op-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L220">view source</a></div></div><div class="public anchor" id="var-def-bin-op"><h3>def-bin-op</h3><h4 class="type">macro</h4><div class="usage"><code>(def-bin-op op-name op-fn)</code></div><div class="doc"><div class="markdown"><p>Define a binary operation</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L203">view source</a></div></div><div class="public anchor" id="var-def-intrin-op"><h3>def-intrin-op</h3><h4 class="type">macro</h4><div class="usage"><code>(def-intrin-op op-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L231">view source</a></div></div><div class="public anchor" id="var-def-op"><h3>def-op</h3><h4 class="type">macro</h4><div class="usage"><code>(def-op op-name make-name)</code></div><div class="doc"><div class="markdown"><p>Define a binary operation</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L211">view source</a></div></div><div class="public anchor" id="var-input-tensors"><h3>input-tensors</h3><div class="usage"><code>(input-tensors compute-op)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L494">view source</a></div></div><div class="public anchor" id="var-iteration-variable"><h3>iteration-variable</h3><div class="usage"><code>(iteration-variable domain name iteration-type &amp; {:keys [thread-tag], :or {thread-tag ""}})</code></div><div class="doc"><div class="markdown"><p>Create a variable that controls iteration through the data. The iteration type affects the class of optimizations that the compiler is able to apply to the affected expressions,</p>
<pre><code>Parameters
----------
dom : Range
    The domain of iteration.

name : str
    The name of iteration variable.

iteration-type : keyword
    The type of iteration.

thread-tag : str
    The thread tag of the iteration variable.
</code></pre></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L366">view source</a></div></div><div class="public anchor" id="var-iteration-variable-type-set"><h3>iteration-variable-type-set</h3><div class="usage"></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L363">view source</a></div></div><div class="public anchor" id="var-iteration-variable-types"><h3>iteration-variable-types</h3><div class="usage"></div><div class="doc"><div class="markdown"><p>Iteration variable types defined in tvm/include/Expr.h</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L298">view source</a></div></div><div class="public anchor" id="var-name-.3Ethread-axis-iterator"><h3>name-&gt;thread-axis-iterator</h3><div class="usage"><code>(name-&gt;thread-axis-iterator axis-name)</code></div><div class="doc"><div class="markdown"><p>Create a thread iter-var from a thread axis name</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L401">view source</a></div></div><div class="public anchor" id="var-output-tensors"><h3>output-tensors</h3><div class="usage"><code>(output-tensors compute-op)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L488">view source</a></div></div><div class="public anchor" id="var-placeholder"><h3>placeholder</h3><div class="usage"><code>(placeholder shape name &amp; {:keys [dtype], :or {dtype "float32"}})</code></div><div class="doc"><div class="markdown"><p>Create a user-supplied tensor variable</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L45">view source</a></div></div><div class="public anchor" id="var-range"><h3>range</h3><div class="usage"><code>(range start end)</code></div><div class="doc"><div class="markdown"><p>Create a range with defined start inclusive and end exclusive</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L58">view source</a></div></div><div class="public anchor" id="var-safe-str"><h3>safe-str</h3><div class="usage"><code>(safe-str str-name)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L30">view source</a></div></div><div class="public anchor" id="var-select"><h3>select</h3><div class="usage"><code>(select bool-stmt true-stmt false-stmt)</code></div><div class="doc"><div class="markdown"><p>Select between two expressions based on a condition. Thus works similar to the clojure ‘if’ statement.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L265">view source</a></div></div><div class="public anchor" id="var-static-cast"><h3>static-cast</h3><div class="usage"><code>(static-cast dtype expr-node)</code></div><div class="doc"><div class="markdown"><p>Cast an item from one datatype to another</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L70">view source</a></div></div><div class="public anchor" id="var-tget"><h3>tget</h3><div class="usage"><code>(tget tensor indices)</code></div><div class="doc"><div class="markdown"><p>Get an item from a tensor</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L170">view source</a></div></div><div class="public anchor" id="var-tvm-fn"><h3>tvm-fn</h3><h4 class="type">macro</h4><div class="usage"><code>(tvm-fn arg-vec &amp; body)</code></div><div class="doc"><div class="markdown"><p>Like (fn) but retains the arglists. Lambda in clojure unfortunately does not.</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L407">view source</a></div></div><div class="public anchor" id="var-tvm-let"><h3>tvm-let</h3><h4 class="type">macro</h4><div class="usage"><code>(tvm-let expr-pairs body)</code></div><div class="doc"><div class="markdown"><p>Lets in tvm must be nested. This leads to an exciting macro. Pairs must be of the form var val-expr. Body is <em>not</em> an implicit do!!</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L282">view source</a></div></div><div class="public anchor" id="var-variable"><h3>variable</h3><div class="usage"><code>(variable name &amp; {:keys [dtype], :or {dtype "int32"}})</code></div><div class="doc"><div class="markdown"><p>Create a scalar variable. Returns a node handle</p></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L38">view source</a></div></div><div class="public anchor" id="var-when-not-error"><h3>when-not-error</h3><h4 class="type">macro</h4><div class="usage"><code>(when-not-error condition throw-clause)</code></div><div class="doc"><div class="markdown"></div></div><div class="src-link"><a href="https://github.com/techascent/tech.ml.dataset/blob/master/src/tvm_clj/ast.clj#L18">view source</a></div></div></div></body></html>